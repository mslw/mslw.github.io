<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="ie=edge">
<meta name=theme-color content="#494f5c">
<meta name=msapplication-TileColor content="#494f5c">
<meta itemprop=name content="Matlab table & string">
<meta itemprop=description content="In this post I am taking a closer look at tables and strings in matlab.
Matlab continuously evolves, and the two data types are fairly recent additions to the language: table was added in R2013b and string in R2016b. Table arrays store tabular data and can make its handling (sorting, filtering, joining etc.) much more convenient than &ldquo;classical&rdquo; cell arrays. In a way, they are similar to dataframes known from R or python / pandas, although more basic."><meta itemprop=datePublished content="2021-05-05T00:00:00+00:00">
<meta itemprop=dateModified content="2021-05-05T00:00:00+00:00">
<meta itemprop=wordCount content="846">
<meta itemprop=keywords content="software,tips & tricks,matlab,"><meta property="og:title" content="Matlab table & string">
<meta property="og:description" content="In this post I am taking a closer look at tables and strings in matlab.
Matlab continuously evolves, and the two data types are fairly recent additions to the language: table was added in R2013b and string in R2016b. Table arrays store tabular data and can make its handling (sorting, filtering, joining etc.) much more convenient than &ldquo;classical&rdquo; cell arrays. In a way, they are similar to dataframes known from R or python / pandas, although more basic.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://mslw.github.io/posts/2021-05-05-matlab-table-string/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-05-05T00:00:00+00:00">
<meta property="article:modified_time" content="2021-05-05T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Matlab table & string">
<meta name=twitter:description content="In this post I am taking a closer look at tables and strings in matlab.
Matlab continuously evolves, and the two data types are fairly recent additions to the language: table was added in R2013b and string in R2016b. Table arrays store tabular data and can make its handling (sorting, filtering, joining etc.) much more convenient than &ldquo;classical&rdquo; cell arrays. In a way, they are similar to dataframes known from R or python / pandas, although more basic.">
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/site.webmanifest>
<link rel=mask-icon href=/safari-pinned-tab.svg color>
<link rel="shortcut icon" href=/favicon.ico>
<title>Matlab table & string</title><link rel=stylesheet href=https://mslw.github.io/css/style.min.037b6ee8f8c1baab6a3d0a9da11c3ff18a7552471f16c59fd98538d5ce99208b.css integrity="sha256-A3tu6PjBuqtqPQqdoRw/8Yp1UkcfFsWf2YU41c6ZIIs=" crossorigin=anonymous>
<link rel=stylesheet href=https://mslw.github.io/fontawesome/css/all.css>
<link rel=stylesheet href=https://mslw.github.io/academicons/css/academicons.css>
</head><body id=page>
<header id=site-header class="animated slideInUp">
<div class="hdr-wrapper section-inner">
<div class=hdr-left>
<div class=site-branding>
<a href=https://mslw.github.io/>Michał Szczepanik</a>
</div><nav class="site-nav hide-in-mobile">
<a href=https://mslw.github.io/posts/>Posts</a>
<a href=https://mslw.github.io/about>About</a>
</nav></div><div class="hdr-right hdr-icons">
<span class="hdr-social hide-in-mobile"><a href=https://github.com/mslw target=_blank rel="noopener me" title=Github><i class="fab fa-github"></i></a><a href=https://orcid.org/0000-0002-4028-2087 target=_blank rel="noopener me" title=Orcid><i class="fab fa-orcid"></i></a></span><button id=menu-btn class=hdr-btn title=Menu><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button>
</div></div></header><div id=mobile-menu class="animated fast">
<ul>
<li><a href=https://mslw.github.io/posts/>Posts</a></li><li><a href=https://mslw.github.io/about>About</a></li></ul></div><main class="site-main section-inner animated fadeIn faster">
<article class=thin>
<header class=post-header>
<div class=post-meta><span>May 5, 2021</span></div><h1>Matlab table & string</h1></header><div class=content>
<p>In this post I am taking a closer look at tables and strings in matlab.</p><p>Matlab continuously evolves, and the two data types are fairly recent additions to the language: <a href=https://www.mathworks.com/help/matlab/ref/table.html>table</a> was added in R2013b and <a href=https://www.mathworks.com/help/matlab/ref/string.html>string</a> in R2016b. Table arrays store tabular data and can make its handling (sorting, filtering, joining etc.) much more convenient than &ldquo;classical&rdquo; cell arrays. In a way, they are similar to dataframes known from R or python / pandas, although more basic. String arrays are a proper string type, and in my opinion they are much more workable then their predecessors, character arrays and cellstrings.</p><p>To demonstrate how useful they can be together, I will show an example modelled after preparing an input for SPM batch (specifically, second level two sample t-test design). If you work in neuroimaging, you&rsquo;ll probably be familiar with SPM, but if not, you will be able to follow along just as well.</p><h1 id=problem-statement>Problem statement<a href=#problem-statement class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>What we have is a tab-separated file <code>participants.tsv</code> with a list of subjects (in accordance with the <a href=https://bids-specification.readthedocs.io/en/stable/03-modality-agnostic-files.html#participants-file>BIDS specification</a>):</p><pre tabindex=0><code>participant_id age group
sub-01         34  read
sub-02         12  write
sub-03         33  read
</code></pre><p>We also have a set of intermediate files (first level output), which we organised in the following way (this time according to our whim, rather than any standard):</p><pre tabindex=0><code>/work/sub-01/task-motor/con_0001.nii
/work/sub-01/task-nback/con_0001.nii
/work/sub-02/task-motor/con_0001.nii
/work/sub-02/task-nback/con_0001.nii
</code></pre><p>What we want to get is two lists of files for the motor task: one for the read group, and one for the write group:</p><pre tabindex=0><code>group1 = {
	/work/sub-01/task-motor/con_0001.nii;
	/work/sub-03/task-motor/con_0001.nii;
	...
	}
group2 = {
	/work/sub-02/task-motor/con_0001.nii;
	...
	}
</code></pre><h1 id=solution>Solution<a href=#solution class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>Let&rsquo;s start by reading the participant file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-matlab data-lang=matlab><span class=line><span class=cl><span class=n>participants</span> <span class=p>=</span> <span class=n>readtable</span><span class=p>(</span><span class=s>&#39;/path/to/participants.tsv&#39;</span><span class=p>,</span> <span class=c>...</span>
</span></span><span class=line><span class=cl>	<span class=s>&#39;FileType&#39;</span><span class=p>,</span> <span class=s>&#39;text&#39;</span><span class=p>,</span> <span class=s>&#39;Delimiter&#39;</span><span class=p>,</span> <span class=s>&#39;\t&#39;</span><span class=p>,</span> <span class=s>&#39;TextType&#39;</span><span class=p>,</span> <span class=s>&#39;string&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>Unfortunately, <code>readtable</code> recognizes <code>.txt</code>, <code>.dat</code> or <code>.csv</code> extensions, but not <code>.tsv</code>, so we have to specify both <code>FileType</code> and <code>Delimiter</code> (either <code>\t</code> or <code>tab</code> will work) in addition to the obligatory file name. Additionally, we use <code>TextType</code> to import text data as string arrays, rather than character vectors. This produces the following:</p><pre tabindex=0><code>participants =

  3×3 table

    participant_id    age     group 
    ______________    ___    _______

       &#34;sub-01&#34;       34     &#34;read&#34; 
       &#34;sub-02&#34;       12     &#34;write&#34;
       &#34;sub-03&#34;       33     &#34;read&#34; 
</code></pre><p>Next, let&rsquo;s add another column with paths to the con files:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-matlab data-lang=matlab><span class=line><span class=cl><span class=n>participants</span><span class=p>.</span><span class=n>con_files</span> <span class=p>=</span> <span class=n>fullfile</span><span class=p>(</span><span class=c>...</span>
</span></span><span class=line><span class=cl>	&#34;<span class=o>/</span><span class=n>work</span>&#34;<span class=p>,</span> <span class=n>participants</span><span class=p>.</span><span class=n>participant_id</span><span class=p>,</span> &#34;<span class=n>task</span><span class=o>-</span><span class=n>motor</span>&#34;<span class=p>,</span> &#34;<span class=n>con_0001</span><span class=p>.</span><span class=n>nii</span>&#34;<span class=p>)</span>
</span></span></code></pre></div><p>The <code>fullfile</code> function joins its arguments by adding a path separator (<code>/</code> or <code>\</code>, depending on system). One of the inputs we gave, <code>particiants.participant_id</code> is a string array (with as many rows as there are subjects), and consequently the output will be a string array of the same shape. Adding a column is as simple as retrieving one, and can be done by using a dot notation with a new name. Convenient. This is what the table looks as a result:</p><pre tabindex=0><code>participants =

  3×4 table

    participant_id    age     group                   con_files               
    ______________    ___    _______    ______________________________________

       &#34;sub-01&#34;       34     &#34;read&#34;     &#34;/work/sub-01/task-motor/con_0001.nii&#34;
       &#34;sub-02&#34;       12     &#34;write&#34;    &#34;/work/sub-02/task-motor/con_0001.nii&#34;
       &#34;sub-03&#34;       33     &#34;read&#34;     &#34;/work/sub-03/task-motor/con_0001.nii&#34;
</code></pre><p>We can next filter the table for each group in turn.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-matlab data-lang=matlab><span class=line><span class=cl><span class=n>read_con</span> <span class=p>=</span> <span class=n>participants</span><span class=p>{</span><span class=n>participants</span><span class=p>.</span><span class=n>group</span> <span class=o>==</span> &#34;<span class=n>read</span>&#34;<span class=p>,</span> &#34;<span class=n>con_files</span>&#34;<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>write_con</span> <span class=p>=</span> <span class=n>participants</span><span class=p>{</span><span class=n>participants</span><span class=p>.</span><span class=n>group</span> <span class=o>==</span> &#34;<span class=n>write</span>&#34;<span class=p>,</span> &#34;<span class=n>con_files</span>&#34;<span class=p>}</span>
</span></span></code></pre></div><p>Here, we used brace indexing to get a subset of rows (since the group column is a string array, we could use <code>==</code> to obtain a logical array of a matching shape for logical indexing) and a single column (by giving its name). In a typical matlab fashion, using round brackets would keep the type of the indexed object and return a table with selected rows and columns, while the curly brackets used above return column content<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> (in this case, a string array). This produces:</p><pre tabindex=0><code>read_con = 

  2×1 string array

    &#34;/work/sub-01/task-motor/con_0001.nii&#34;
    &#34;/work/sub-03/task-motor/con_0001.nii&#34;


write_con = 

    &#34;/work/sub-02/task-motor/con_0001.nii&#34;
</code></pre><p>Finally, since SPM batch requires cellstrings rather than string arrays, we can do a simple conversion:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-matlab data-lang=matlab><span class=line><span class=cl><span class=n>group1</span> <span class=p>=</span> <span class=n>cellstr</span><span class=p>(</span><span class=n>read_con</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>group2</span> <span class=p>=</span> <span class=n>cellstr</span><span class=p>(</span><span class=n>write_con</span><span class=p>)</span>
</span></span></code></pre></div><pre tabindex=0><code>group1 =

  2×1 cell array

    {&#39;/work/sub-01/task-motor/con_0001.nii&#39;}
    {&#39;/work/sub-03/task-motor/con_0001.nii&#39;}


group2 =

  1×1 cell array

    {&#39;/work/sub-02/task-motor/con_0001.nii&#39;}
</code></pre><h1 id=further-comments>Further comments<a href=#further-comments class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><p>Naturally, the example above was fairly basic, and there is more that can be done with strings and tables. Here are some things that I found particularly useful.</p><p>You can join string arrays using <code>+</code> (eg. you could use <code>"sub-" + participants.participant_id</code> if the &ldquo;sub-&rdquo; prefix was missing). If you are a fan of <code>sprintf</code>, you can use <a href=https://www.mathworks.com/help/matlab/ref/compose.html>compose</a> as its &ldquo;vectorised&rdquo; alternative (eg. <code>compose("sub-%s", participants.participant_id)</code>) for a similar effect. Should you wish to replace part of the string, you can use things like <a href=https://www.mathworks.com/help/matlab/ref/replace.html>replace</a>, eg. <code>replace(participants.participant_id, "sub-", "subject-")</code>. For filtering, you might want to use <a href=https://www.mathworks.com/help/matlab/ref/startswith.html>startsWith</a> and the like.</p><p>For tables, in addition to the regular <code>size</code> function there are intuitive <code>height</code> and <code>width</code> functions. If you have another table (perhaps with behavioural scores) with the same participant IDs but different ordering, you can join them using <a href=https://www.mathworks.com/help/matlab/ref/table.join.html>join</a>. And finally, if you need to sort a table first by one column, and then by another (breaking ties), you can do so using <a href=https://www.mathworks.com/help/matlab/ref/double.sortrows.html>sortrows</a>, as in <code>sortrows(participants, {'group', 'age'})</code> (which also allows you to specify ascending or descending order independently).</p><h1 id=footnotes>Footnotes<a href=#footnotes class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h1><section class=footnotes role=doc-endnotes>
<hr>
<ol>
<li id=fn:1 role=doc-endnote>
<p>Strictly speaking, curly brackets return an array concatenated from the content of selected rows and columns. a single-column example I prefer thinking of it simply as column content. You can read more about table indexing in the docs: <a href=https://www.mathworks.com/help/matlab/matlab_prog/access-data-in-a-table.html>Access Data in Tables</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div><hr class=post-end>
<footer class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-feather"><path d="M20.24 12.24a6 6 0 00-8.49-8.49L5 10.5V19h8.5z"/><line x1="16" y1="8" x2="2" y2="22"/><line x1="17.5" y1="15" x2="9" y2="15"/></svg>Michał Szczepanik</p><p>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://mslw.github.io/tags/software>software</a></span><span class=tag><a href=https://mslw.github.io/tags/tips-tricks>tips & tricks</a></span><span class=tag><a href=https://mslw.github.io/tags/matlab>matlab</a></span>
</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>846 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2021-05-05 00:00 +0000</p></footer></article><div class="post-nav thin">
<a class=next-post href=https://mslw.github.io/posts/2021-06-01-combining-nilearn-plots/>
<span class=post-nav-label><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>&nbsp;Newer</span><br><span>Combining nilearn plots</span>
</a>
<a class=prev-post href=https://mslw.github.io/posts/2021-03-19-giving-in-to-pyenv/>
<span class=post-nav-label>Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span><br><span>Giving in to pyenv</span>
</a>
</div><div id=comments class=thin>
</div></main><footer id=site-footer class="section-inner thin animated fadeIn faster">
<p>&copy; 2022 <a href=https://mslw.github.io/>Michał Szczepanik</a> &#183; <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></p><p>
Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> &#183; Theme <a href=https://github.com/Track3/hermit target=_blank rel=noopener>Hermit</a> &#183; <a href=https://mslw.github.io/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a>
</p></footer><script src=https://mslw.github.io/js/bundle.min.8256b8724b9578bbdf6d6f04c894255bc760e78e8a2d60ec0a91ea993acd3b77.js integrity="sha256-gla4ckuVeLvfbW8EyJQlW8dg546KLWDsCpHqmTrNO3c=" crossorigin=anonymous></script>
</body></html>