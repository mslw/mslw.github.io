<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="ie=edge">
<meta name=theme-color content="#494f5c">
<meta name=msapplication-TileColor content="#494f5c">
<meta itemprop=name content="Dealing with arcane bullshit">
<meta itemprop=description content="Being a young scientist, at times I find myself having to deal with some programing related arcane bullshit. This post is something I wanted to write about for a while.
Case 1: video stimuli The primary culprit in this case is Presentation software from Neurobehavioral Systems, which, fittingly for its name, is a software for rigorously timed stimulus presentation. To be clear - it&rsquo;s a very good, very reliable program and it has been serving our lab well for several years."><meta itemprop=datePublished content="2019-11-07T22:30:00+01:00">
<meta itemprop=dateModified content="2019-11-07T22:30:00+01:00">
<meta itemprop=wordCount content="1301">
<meta itemprop=keywords content="randomthoughts,"><meta property="og:title" content="Dealing with arcane bullshit">
<meta property="og:description" content="Being a young scientist, at times I find myself having to deal with some programing related arcane bullshit. This post is something I wanted to write about for a while.
Case 1: video stimuli The primary culprit in this case is Presentation software from Neurobehavioral Systems, which, fittingly for its name, is a software for rigorously timed stimulus presentation. To be clear - it&rsquo;s a very good, very reliable program and it has been serving our lab well for several years.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://mslw.github.io/posts/2019-11-07-arcane-bullshit/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2019-11-07T22:30:00+01:00">
<meta property="article:modified_time" content="2019-11-07T22:30:00+01:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Dealing with arcane bullshit">
<meta name=twitter:description content="Being a young scientist, at times I find myself having to deal with some programing related arcane bullshit. This post is something I wanted to write about for a while.
Case 1: video stimuli The primary culprit in this case is Presentation software from Neurobehavioral Systems, which, fittingly for its name, is a software for rigorously timed stimulus presentation. To be clear - it&rsquo;s a very good, very reliable program and it has been serving our lab well for several years.">
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/site.webmanifest>
<link rel=mask-icon href=/safari-pinned-tab.svg color>
<link rel="shortcut icon" href=/favicon.ico>
<title>Dealing with arcane bullshit</title><link rel=stylesheet href=https://mslw.github.io/css/style.min.037b6ee8f8c1baab6a3d0a9da11c3ff18a7552471f16c59fd98538d5ce99208b.css integrity="sha256-A3tu6PjBuqtqPQqdoRw/8Yp1UkcfFsWf2YU41c6ZIIs=" crossorigin=anonymous>
<link rel=stylesheet href=https://mslw.github.io/fontawesome/css/all.css>
<link rel=stylesheet href=https://mslw.github.io/academicons/css/academicons.css>
</head><body id=page>
<header id=site-header class="animated slideInUp">
<div class="hdr-wrapper section-inner">
<div class=hdr-left>
<div class=site-branding>
<a href=https://mslw.github.io/>Michał Szczepanik</a>
</div><nav class="site-nav hide-in-mobile">
<a href=https://mslw.github.io/posts/>Posts</a>
<a href=https://mslw.github.io/about>About</a>
</nav></div><div class="hdr-right hdr-icons">
<span class="hdr-social hide-in-mobile"><a href=https://github.com/mslw target=_blank rel="noopener me" title=Github><i class="fab fa-github"></i></a><a href=https://orcid.org/0000-0002-4028-2087 target=_blank rel="noopener me" title=Orcid><i class="fab fa-orcid"></i></a></span><button id=menu-btn class=hdr-btn title=Menu><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button>
</div></div></header><div id=mobile-menu class="animated fast">
<ul>
<li><a href=https://mslw.github.io/posts/>Posts</a></li><li><a href=https://mslw.github.io/about>About</a></li></ul></div><main class="site-main section-inner animated fadeIn faster">
<article class=thin>
<header class=post-header>
<div class=post-meta><span>Nov 7, 2019</span></div><h1>Dealing with arcane bullshit</h1></header><div class=content>
<p>Being a young scientist, at times I find myself having to deal with some programing related arcane bullshit. This post is something I wanted to write about for a while.</p><p><img src=https://imgs.xkcd.com/comics/arcane_bullshit.png alt="xkcd no 1671"></p><h3 id=case-1-video-stimuli>Case 1: video stimuli<a href=#case-1-video-stimuli class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>The primary culprit in this case is Presentation software from Neurobehavioral Systems, which, fittingly for its name, is a software for rigorously timed stimulus presentation. To be clear - it&rsquo;s a very good, very reliable program and it has been serving our lab well for several years. It allows for frame-perfect presentation of visual stimuli, playing sounds, creating logs and synchronising with other lab equipment. It has its quirks though. And given that many problems can be solved by bashing one&rsquo;s head on the keyboard long enough (i. e. by spending lots of time reading the documentation and trying things out) I have earned a reputation within our lab for making Presentation work.</p><p>One of the things I had to deal with was playing video. The features list states that it can <em>display compressed video using any DirectShow compatible codecs installed on your system</em>. In practice, only after trying to play some file given to you by your colleague do you realise that only .avi container can be opened. And after converting to .avi things still fail, with a cryptic error message about calls to DirectX going wrong.</p><p>The solution comes from a semi-official wiki, on which the <a href=http://www.neurobs.com/wiki/Presentation/Video>video</a> page is immensly helpful. The problem is due to codecs. First, you should ideally be using x264, because it&rsquo;s tried and tested. Second, you need to have ffdshow software installed on your PC to ensure that those codecs are available where they are needed (your video player working does not mean Presentation would work too). And as a cherry on top, you need to override some system settings. So you keep telling yourself that you are a serious scientist while you get flashbacks of the 2000&rsquo;s as you download and launch a somewhat shady looking program called Codec Tweek Tool (to make things even more arcane, the wiki specifically tells you to get version 6.1.1 because later releases removed the required functionality). Afterwards, things begin to work.</p><p>As a side note, for my current study I need to prepare mp4 files by cutting, resizing, removing audio and converting. My tool of choice is ffmpeg and I keep the following command as a very precious note, maybe it comes useful for somebody else too (the <code>-strict</code> and <code>-experimental</code> flags seem essential for good video quality; <code>-ss</code> and <code>-t</code> are for selecting the right fragment, <code>-vf scale=...</code> scales and <code>-c:v</code> selects the codec):</p><pre tabindex=0><code>ffmpeg -ss &lt;start time&gt; -i INFILE.mp4 -t &lt;duration&gt; -vf scale=1440:1080 -c:v libx264 -an -strict -experimental OUT.avi
</code></pre><h3 id=case-2-port-codes-in-recorder>Case 2: port codes in Recorder<a href=#case-2-port-codes-in-recorder class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>Second example involves an interface between Presentation and Brain Vision Recorder, again an established and reliable software, used for EEG and other physiological recordings. In many experiments, we mark the presentation of stimuli in the EEG signal by sending markers over an LPT port (essentially using an old printer cable). In Presentation, the experimenter simply needs to assign a number (port code) from 1-128 range to a stimulus.</p><p>Behind the scenes, in technical terms, the LPT port has 8 signal lines (8 pins used to send signals) which can be switched from low (0 volts) to high (5 volts) state for several milliseconds with negligible latency. This allows for sending port codes in binary format, so for example number 21 is represented by pins 0, 2 and 4 (I am counting from 0) being set to high, because 21 equals 2^0 + 2^2 + 2^4.</p><p>However, by default, Recorder uses only pins 0-3 for stimulus markers, and pins 4-7 for response markers. Therefore, it interprets the above input as Stimulus 5 (2^0 + 2^2) and Response 1 (2^0 as pins 4-7 are counted anew) ocurring at the same time. Such behavior can be useful, can be changed in Recorder&rsquo;s menu, and is described in Recorder&rsquo;s manual, but can be extremely confusing when all you have is a recording where markers are all wrong. And it has caught out several of my colleagues already and gave us a bit of a puzzle for the first time it happened. Turns out that binary representations are useful in life.</p><h3 id=case-3-inhouse-usb-too-usb>Case 3: inhouse USB-too-USB<a href=#case-3-inhouse-usb-too-usb class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>Speaking of interfacing, there was a time when we had to send some markers through a COM port (a different kind of port, which in this case allows sending pieces of text) using an inhouse USB-to-USB connector. The receiving program (also inhouse) required messages to end with a new line, windows style (which is actually two characters from the <a href=https://en.wikipedia.org/wiki/ASCII>ASCII</a> table, &ldquo;carriage return&rdquo; followed by &ldquo;line feed&rdquo;, usually represented as <code>\r\n</code>). And while Presentation interprets the <code>\n</code> symbol correctly, for some reason it would not accept the <code>\r</code> typed in the script. Luckily, it accepts hexadecimal codes, so the solution was (if I remember correctly) to type it in as <code>\x0D\n</code> (0D in hexadecimal translates to 13 in decimal or 00001101 in binary, which is the ASCII code for &ldquo;carriage return&rdquo;). I believe that many people would classify that as an obscure piece of knowledge.</p><h3 id=case-4-explicit-mask-in-spm>Case 4: explicit mask in SPM<a href=#case-4-explicit-mask-in-spm class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>Another example: some time ago I was trying to use the <em>explicit mask</em> option in SPM (arguably the most popular software for fMRI analysis), but got a strange error. The explicit mask is neither a standard, nor a very uncommon setting. After spending hours trying to find an error in my data I tried the same on my colleague&rsquo;s computer, and it worked out of the box. However, he had an older version of SPM. Working from there I could check the source code (luckily that&rsquo;s possible for a toolbox created in Matlab) and locate the error. Only then did I find out that the solution had been posted several months earlier on the SPM&rsquo;s mailing list (but for that I had to search the topics on the mailing list for mentions of the offending function, googling the error message before yielded nothing of use). This was SPM12 revision 6906, published in October 2016 and replaced by revision 7219 in November 2017. For a year, the fix had to be downloaded from a mailing list (or done manually, as it was pretty much a one-liner).</p><h3 id=case-5-multiple-displays>Case 5: multiple displays<a href=#case-5-multiple-displays class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>The final example is related to HDMI cables and still remains a bit of a mistery to me. In our ongoing experiment we needed to show different things (including picture from a GoPro camera) at different screens at different times. One iteration of our setup (luckily replaced by a more efficient solution) used an HDMI splitter (sends one input to two screens) and had us swap out the cables manually. We found out that after plugging in a cable, we sometimes got the image on one screen, sometimes on the other, and sometimes, seemingly at random, on both (the way we wanted). It turns out that the workings of HDMI are more complex than we initially thought. I don&rsquo;t know the details, but after the connection is made, the computer probes the output devices for their display parameters and adjusts accordingly. If the devices on the other side of the splitter are different, it might get a response from either of them, thus leading to unexpected behaviour (thanks to Alex for pointing that out when we discussed our options over e-mail).</p><h3 id=summary>Summary<a href=#summary class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>What&rsquo;s the moral of all the stories? Apart from the fact that when using different pieces of software and hardware together one should <em>expect</em> things to go wrong and that documentation for scientific software may or may not be lacking it is this: more people should learn things like what ASCII is and how numbers are represented in binary. It does come useful.</p></div><hr class=post-end>
<footer class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-feather"><path d="M20.24 12.24a6 6 0 00-8.49-8.49L5 10.5V19h8.5z"/><line x1="16" y1="8" x2="2" y2="22"/><line x1="17.5" y1="15" x2="9" y2="15"/></svg>Michał Szczepanik</p><p>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://mslw.github.io/tags/randomthoughts>randomthoughts</a></span>
</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>1301 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2019-11-07 21:30 +0000</p></footer></article><div class="post-nav thin">
<a class=next-post href=https://mslw.github.io/posts/2019-11-19-beyond-meat/>
<span class=post-nav-label><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>&nbsp;Newer</span><br><span>Beyond Meat</span>
</a>
<a class=prev-post href=https://mslw.github.io/posts/2019-11-05-why-blog/>
<span class=post-nav-label>Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span><br><span>Why blog</span>
</a>
</div><div id=comments class=thin>
</div></main><footer id=site-footer class="section-inner thin animated fadeIn faster">
<p>&copy; 2022 <a href=https://mslw.github.io/>Michał Szczepanik</a> &#183; <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></p><p>
Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> &#183; Theme <a href=https://github.com/Track3/hermit target=_blank rel=noopener>Hermit</a> &#183; <a href=https://mslw.github.io/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a>
</p></footer><script src=https://mslw.github.io/js/bundle.min.8256b8724b9578bbdf6d6f04c894255bc760e78e8a2d60ec0a91ea993acd3b77.js integrity="sha256-gla4ckuVeLvfbW8EyJQlW8dg546KLWDsCpHqmTrNO3c=" crossorigin=anonymous></script>
</body></html>